@model List<ChatApp.Data.Models.Message>
@{
    ViewBag.Title = "Home Page";
}

@section styles {
    <link href="~/Content/chat.css" rel="stylesheet" />
}

<input type="hidden" id="hidUserName" value="@Context.User.Identity.Name" />

<div class="container">
    <div class="messaging">
        <div class="inbox_msg">
            <div class="inbox_people">
                <div class="headind_srch">
                    <div class="recent_heading">
                        <h4>Online</h4>
                    </div>
                </div>
                <div class="inbox_chat">
                    <ul id="listUserOnline"></ul>
                    @*<button type="button" class="btn btn-default" id="btnBottom">Test</button>*@
                </div>
            </div>

            <div class="mesgs">
                <div class="msg_history">
                    @foreach (var item in Model)
                    {
                        if (item.UserName != Context.User.Identity.Name)
                        {
                            <div class="incoming_msg">
                                <div class="incoming_msg_img"> <img src="https://ptetutorials.com/images/user-profile.png" alt="sunil"> </div>
                                <div class="received_msg">
                                    <div class="received_withd_msg">
                                        <div>@item.Content</div>
                                        <span class="time_date">@item.UserName - @item.DateCreated.ToString("dd/MM/yyyy hh:mm:ss tt")</span>
                                    </div>
                                </div>
                            </div>
                        }
                        else
                        {
                            <div class="outgoing_msg">
                                <div class="sent_msg">
                                    <div>@item.Content</div>
                                    <span class="time_date">@item.DateCreated.ToString("dd/MM/yyyy hh:mm:ss tt")</span>
                                </div>
                            </div>
                        }
                    }
                </div>
                <div class="type_msg">
                    <div class="input_msg_write">
                        <input type="text" class="write_msg" id="message" placeholder="Nhập nội dung" />
                        <button class="msg_send_btn" type="button" id="sendmessage">
                            <i class="fa fa-paper-plane-o" aria-hidden="true"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts {
    <!--Script references. -->
    <!--The jQuery library is required and is referenced by default in _Layout.cshtml. -->
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/moment.min.js"></script>
    <script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script src="~/Scripts/chat.js"></script>
    <script>
        var chat = new Chat();
        chat.initialize();
    </script>
}